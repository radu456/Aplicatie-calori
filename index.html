<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculatorul Tău de Calorii</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="logo_192.png" type="image/png">
  <meta name="theme-color" content="#56ab2f">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
    body {
      background: linear-gradient(to right, #a8e063, #56ab2f);
      color: white;
      text-align: center;
      padding: 2rem;
    }
    h1 { font-size: 2.5rem; margin-bottom: 2rem; }
    .search-container { margin-bottom: 2rem; }
    .search-container input {
      padding: 0.8rem 1rem;
      border-radius: 25px;
      border: 3px solid orange;
      width: 300px;
      font-size: 1rem;
      color: black;
      outline: none;
    }
    .ingredients-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .ingredient-btn {
      padding: 0.6rem 1.2rem;
      background: white;
      color: green;
      border-radius: 20px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.1s ease;
    }
    .ingredient-btn:hover { transform: scale(0.95); }
    .total-btn {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: white;
      color: green;
      padding: 0.5rem 1rem;
      border-radius: 10px;
      font-weight: bold;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      cursor: pointer;
    }
    .popup {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: black;
      padding: 2rem;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      display: none;
      flex-direction: column;
      align-items: center;
      z-index: 1000;
    }
    .popup input {
      margin-top: 1rem;
      padding: 0.5rem;
      border-radius: 10px;
      border: 1px solid gray;
    }
    .popup button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      border: none;
      background: orange;
      color: white;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
    }
    .close-popup {
      background: white;
      color: red;
      border: 2px solid red;
      margin-top: 0.5rem;
    }
    .item {
      background: white;
      color: green;
      padding: 0.8rem;
      margin: 0.5rem auto;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .item-controls button {
      margin-left: 0.5rem;
      font-size: 1rem;
      padding: 0.2rem 0.5rem;
      border-radius: 5px;
      cursor: pointer;
      border: none;
    }
    .edit-btn { background: orange; color: white; }
    .delete-btn { background: red; color: white; }
    .delete-all-btn {
      background: red;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 10px;
      margin-top: 1rem;
    }
    .update-btn {
      background: dodgerblue;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 10px;
      margin-top: 1rem;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    .back-btn {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: white;
      color: purple;
      font-weight: bold;
      border-radius: 10px;
      border: none;
      cursor: pointer;
    }
    .load-more-btn {
      background: white;
      color: green;
      padding: 0.5rem 1.5rem;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      border: 3px solid orange;
    }
    .cos-total-box {
      background: white;
      color: #56ab2f;
      font-weight: bold;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      display: inline-block;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      margin-top: 1rem; /* 🔧 AICI AM MODIFICAT */
      margin-bottom: 1.5rem;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <div id="paginaPrincipala">
    <h1>Calculatorul Tău de Calorii</h1>
    <div class="search-container">
      <input type="text" id="search" placeholder="Caută un aliment...">
    </div>
    <div class="ingredients-list" id="ingredientList"></div>
    <div id="loadMoreContainer"></div>
    <div class="total-btn" onclick="deschideCos()">🔥 Total: <span id="totalKcal">0</span> kcal</div>
  </div>

  <div class="popup" id="popup">
    <div id="popupText">Câte grame?</div>
    <input type="number" id="gramajInput" placeholder="Grame...">
    <button onclick="adaugaIngredient()">Adaugă</button>
    <button class="close-popup" onclick="inchidePopup()">Închide</button>
  </div>

  <div id="paginaCos" style="display: none;">
    <h2>Ingredientele tale</h2>
    <div id="totalKcalCos" class="cos-total-box">🔥 Total: 0 kcal</div>
    <div id="listaCosIngrediente"></div>
    <div id="stergeTotContainer"></div>
    <button class="update-btn" onclick="actualizeazaCos()">🔄 Actualizează coș</button>
    <button class="back-btn" onclick="inapoiLaCalculator()">🔙 Înapoi</button>
  </div>

  <script>
    const caloriiPerGram = {
          'Orez fiert': 1.3,
    'Paste penne': 3.59,
    'Spaghete': 3.59,
    'Baton Nesquik lapte': 3.95,
    'Cașcaval Delaco': 3.23,
    'Pesmet panko': 3.34,
    'Stafide': 3.40,
    'Pesmet auriu granulat': 3.55,
    'Delikat găină': 1.34,
    'Orez basmati nefiert': 3.57,
    'Biscuiți Paradis': 4.59,
    'Baton Trix': 3.84,
    'Bueno Ciocolata': 5.72,
    'Griș de grâu': 3.49,
    'Făină': 3.51,
    'Fulgi de porumb cu îndulcitori Mega Image': 3.68,
    'Cereale Lion Wildcrush': 4.32,
    'Milkshake vanilie Dr. Oetker': 1.07,
    'Ciocolată albă La Festa': 3.89,
    'Mălai': 3.47,
    'Budincă Special Creme Ole Dr. Oetker': 1.11,
    'Ciocolată Milka': 5.39,
    'Orez nefiert Camolino': 3.44,
    'Sos chifteluțe IKEA': 0.80,
    'Maioneză Hellmanns': 6.71,
    'Smântână Casa Bună': 1.31,
    'Portocale': 0.47,
    'Sos BBQ': 1.79,
    'Smântână pentru gătit Dorna': 3.07,
    'Ketchup Tomi': 0.84,
    'Lapte 3.5%': 0.65,
    'Lapte 1.5%': 0.44,
    'Fidea cuiburi': 3.50,
    'Semințe prăjite și sărate': 5.55,
    'Mămăligă': 1.00,
    'Cartofi copți': 0.90,
    'Ulei de măsline': 8.90,
    'Brânză': 3.20,
    'Nutella': 5.39,
    'Crema de fistic 45%': 5.73,
    'Dulceață merișoare IKEA': 1.7,
    'Șuncă țărănească afumată Cris-Tim': 2.03,
    'Unt 82%': 7.38,
    'Ardei capia în oțet': 0.18,
    'Ulei': 8.28,
    'Sos Burger': 3.42,
    'Înghețată Pirulo Fructe Joy': 0.88,
    'Creier miel crud': 1.32,
    'Telemea de oaie': 2.7,
    'Brânză de oaie': 2.7,
    'Carne tocată de vită': 2.32,
    'Cartofi congelați': 1.35,
    'Nuggets Papane': 2.33,
    'Mere': 0.52,
    'Pere': 0.57,
    'Banane': 0.89,
    'Ananas conservat': 0.60,
    'Piersici din compot': 0.69,
    'Struguri albi': 0.69,
    'Roșii': 0.18,
    'Castraveți': 0.16,
    'Ceapă': 0.40,
    'Morcovi': 0.41,
    'Broccoli fiert': 0.35,
    'Conopidă fiartă': 0.25,
    'Fasole verde fiartă': 0.35,
    'Mazăre fiartă': 0.84,
    'Linte fiartă': 1.16,
    'Năut fiert': 1.64,
    'Ou fiert': 1.55,
    'Ou prăjit': 2.00,
    'Cârnați prăjiți': 3.20,
    'Bacon prăjit': 5.40,
    'Piept de pui fiert': 1.65,
    'Piept de pui la grătar': 1.85,
    'Pulpe de pui la cuptor': 1.85,
    'Carne vită fiartă': 2.00,
    'Mușchi de porc la grătar': 2.42,
    'Pește somon gătit': 2.06,
    'Pește pangasius prăjit': 1.85,
    'Ton conservat în apă': 1.16,
    'Ton conservat în ulei': 1.98,
    'Iaurt simplu 2%': 0.60,
    'Iaurt grecesc 10%': 1.20,
    'Brânză cottage': 0.98,
    'Brânză topită': 2.59,
    'Smântână 20%': 2.04,
    'Chipsuri Lay’s': 5.32,
    'Pufuleti Gusto': 4.71,
    'Popcorn fără unt': 3.87,
    'Popcorn cu unt': 5.31,
    'Pâine albă': 2.64,
    'Pâine integrală': 2.47,
    'Croissant simplu': 4.06,
    'Croissant cu ciocolată': 4.46,
    'Napolitane cu cacao': 5.28,
    'Biscuiți Oreo': 4.74,
    'Cheesecake': 3.21,
    'Tiramisu': 2.87,
    'Pandișpan simplu': 3.49,
    'Clătite simple': 2.22,
    'Clătite cu gem': 2.63,
    'Supa de legume': 0.25,
    'Usturoi': 1.49,
    'Varză albă': 0.25,
    'Varză roșie': 0.32,
    'Broccoli crud': 0.34,
    'Sparanghel': 0.20,
    'Salată iceberg': 0.14,
    'Andive': 0.17,
    'Fenicul': 0.31,
    'Dovleac plăcintar': 0.20,
    'Ciuperci shiitake': 0.48,
    'Mango': 0.61,
    'Kiwi': 0.61,
    'Papaya': 0.39,
    'Lămâie': 0.28,
    'Lime': 0.30,
    'Cătină': 0.82,
    'Coacăze negre': 0.63,
    'Coacăze roșii': 0.56,
    'Nucă de cocos crudă': 3.54,
    'Fructul pasiunii': 0.97,
    'Năut crud': 3.64,
    'Linte roșie crudă': 3.58,
    'Fasole neagră': 3.39,
    'Migdale crude': 5.76,
    'Migdale prăjite': 5.79,
    'Caju crud': 5.53,
    'Fistic prăjit': 5.62,
    'Arahide crude': 5.67,
    'Semințe de susan': 5.73,
    'Semințe de in': 5.34,
    'Cod': 0.82,
    'Merluciu': 0.85,
    'Crap': 1.05,
    'Știucă': 0.90,
    'Zander (biban de mare)': 0.90,
    'Caracatiță': 0.82,
    'Midii': 0.86,
    'Scoici': 0.85,
    'Rac fiert': 0.90,
    'Homar': 0.89,
    'Creier de porc': 1.38,
    'Gât de porc': 2.04,
    'Coaste de porc': 1.89,
    'Rasol de vită': 1.32,
    'Rasol de porc': 2.11,
    'Pulpe de curcan': 1.45,
    'Aripioare de curcan': 1.65,
    'Ruladă de pui': 1.60,
    'Șnițel de pui pane': 2.33,
    'Salam Victoria': 4.50,
    'Lapte de cocos (conservă)': 2.01,
    'Lapte de ovăz': 0.44,
    'Lapte de soia': 0.43,
    'Brânză de capră': 2.70,
    'Brânză halloumi': 3.21,
    'Ricotta': 1.38,
    'Mozzarella': 2.43,
    'Telemea de bivoliță': 2.19,
    'Iaurt vegetal (soia)': 0.52,
    'Lapte condensat': 3.25,
    'Covrig simplu': 2.50,
    'Covrig cu mac': 2.45,
    'Covrig cu susan': 2.65,
    'Pâine de secară': 2.58,
    'Pâine neagră': 2.49,
    'Pâine cu semințe': 2.47,
    'Chiflă albă': 2.63,
    'Chiflă integrală': 2.76,
    'Focaccia': 3.20,
    'Lipie': 2.75,
    'Ciocolată neagră 85%': 6.27,
    'Ciocolată cu alune': 5.54,
    'Prăjitură Amandină': 2.44,
    'Prăjitură Ecler': 3.25,
    'Napolitane cu cremă de lapte': 4.82,
    'Napolitane cu alune': 4.81,
    'Acadea': 3.87,
    'Jeleuri Haribo': 3.43,
    'Biscuiți Petit Beurre': 4.50,
    'Baton de susan': 5.00,
    'Sos sweet chili': 1.80,
    'Sos de soia': 0.72,
    'Sos teriyaki': 1.20,
    'Sos tzatziki': 1.10,
    'Sos de usturoi': 2.00,
    'Sos de hrean': 1.50,
    'Muștar clasic': 0.66,
    'Muștar iute': 0.70,
    'Sos tartar': 2.50,
    'Sos de soia light': 0.40,
    'Ou crud': 1.39,
    'Albuș crud': 0.52,
    'Albuș fiert': 0.52,
    'Albuș prăjit': 0.52,
    'Gălbenuș crud': 3.17,
    'Gălbenuș fiert': 3.22,
    'Gălbenuș prăjit': 3.22,
    'Praf de copt': 0.00,
    'Drojdie uscată': 2.95,
    'Zahăr alb': 4.00,
    'Zahăr brun': 3.98,
    'Miere': 3.25,
    'Sirop de arțar': 2.61,
    'Sirop de agave': 3.10,
    };

    const ingredientList = document.getElementById('ingredientList');
    const popup = document.getElementById('popup');
    const gramajInput = document.getElementById('gramajInput');
    const totalKcalSpan = document.getElementById('totalKcal');
    const totalKcalCosSpan = document.getElementById('totalKcalCos');
    const searchInput = document.getElementById('search');
    const popupText = document.getElementById('popupText');
    const cosContainer = document.getElementById('listaCosIngrediente');
    const stergeTotContainer = document.getElementById('stergeTotContainer');
    const loadMoreContainer = document.getElementById('loadMoreContainer');

    let lista = [];
    let totalKcal = 0;
    let alimentCurent = null;
    let indexEdit = null;
    let afisateInitial = 8;
    let pasAfisare = 20;
    let numarAfisate = afisateInitial;
    let ingredienteFiltrate = [];

    function renderIngrediente(filter = '') {
      ingredientList.innerHTML = '';
      loadMoreContainer.innerHTML = '';
      ingredienteFiltrate = Object.keys(caloriiPerGram)
        .sort()
        .filter(nume => nume.toLowerCase().includes(filter.toLowerCase()));
      const deAfisat = ingredienteFiltrate.slice(0, numarAfisate);
      deAfisat.forEach(nume => {
        const btn = document.createElement('div');
        btn.className = 'ingredient-btn';
        btn.innerText = nume;
        btn.onclick = () => {
          alimentCurent = nume;
          indexEdit = null;
          gramajInput.value = '';
          popupText.innerText = `Câte grame de ${nume}?`;
          popup.style.display = 'flex';
        };
        ingredientList.appendChild(btn);
      });
      if (numarAfisate < ingredienteFiltrate.length) {
        const moreBtn = document.createElement('button');
        moreBtn.className = 'load-more-btn';
        moreBtn.innerText = 'Încarcă mai multe';
        moreBtn.onclick = () => {
          numarAfisate += pasAfisare;
          renderIngrediente(filter);
        };
        loadMoreContainer.appendChild(moreBtn);
      }
    }

    function adaugaIngredient() {
      const gramaj = parseFloat(gramajInput.value);
      if (isNaN(gramaj) || gramaj <= 0) return;
      const kcal = caloriiPerGram[alimentCurent] * gramaj;
      if (indexEdit !== null) {
        totalKcal -= lista[indexEdit].kcal;
        lista[indexEdit] = { nume: alimentCurent, gramaj, kcal };
        indexEdit = null;
      } else {
        lista.push({ nume: alimentCurent, gramaj, kcal });
      }
      totalKcal = lista.reduce((acc, cur) => acc + cur.kcal, 0);
      totalKcalSpan.innerText = totalKcal.toFixed(2);
      popup.style.display = 'none';
      salveazaInLocalStorage();
    }

    function inchidePopup() {
      popup.style.display = 'none';
      indexEdit = null;
    }

    function deschideCos() {
      document.getElementById('paginaPrincipala').style.display = 'none';
      document.getElementById('paginaCos').style.display = 'block';
      actualizeazaCos();
    }

    function inapoiLaCalculator() {
      document.getElementById('paginaCos').style.display = 'none';
      document.getElementById('paginaPrincipala').style.display = 'block';
    }

    function actualizeazaCos() {
      cosContainer.innerHTML = '';
      stergeTotContainer.innerHTML = '';
      totalKcalCosSpan.innerText = `🔥 Total: ${totalKcal.toFixed(2)} kcal`;
      if (lista.length === 0) {
        cosContainer.innerHTML = "<p>Nu ai adăugat niciun ingredient.</p>";
      } else {
        lista.forEach((item, i) => {
          const div = document.createElement('div');
          div.className = 'item';
          div.innerHTML = `
            <span>${item.nume} (${item.gramaj}g)</span>
            <strong>${item.kcal.toFixed(2)} kcal</strong>
            <div class="item-controls">
              <button class="edit-btn" onclick="editeaza(${i})">✏️</button>
              <button class="delete-btn" onclick="sterge(${i})">❌</button>
            </div>
          `;
          cosContainer.appendChild(div);
        });
        const btn = document.createElement('button');
        btn.className = 'delete-all-btn';
        btn.innerText = 'Șterge tot';
        btn.onclick = stergeTot;
        stergeTotContainer.appendChild(btn);
      }
    }

    function sterge(i) {
      totalKcal -= lista[i].kcal;
      lista.splice(i, 1);
      totalKcalSpan.innerText = totalKcal.toFixed(2);
      actualizeazaCos();
      salveazaInLocalStorage();
    }

    function stergeTot() {
      lista = [];
      totalKcal = 0;
      totalKcalSpan.innerText = '0';
      actualizeazaCos();
      salveazaInLocalStorage();
    }

    function editeaza(i) {
      const item = lista[i];
      alimentCurent = item.nume;
      indexEdit = i;
      gramajInput.value = item.gramaj;
      popupText.innerText = `Câte grame de ${alimentCurent}?`;
      popup.style.display = 'flex';
    }

    function salveazaInLocalStorage() {
      localStorage.setItem('cosIngrediente', JSON.stringify(lista));
    }

    function incarcaDinLocalStorage() {
      const salvate = localStorage.getItem('cosIngrediente');
      if (salvate) {
        lista = JSON.parse(salvate);
        totalKcal = lista.reduce((acc, cur) => acc + cur.kcal, 0);
        totalKcalSpan.innerText = totalKcal.toFixed(2);
      }
    }

    searchInput.addEventListener('input', () => {
      numarAfisate = afisateInitial;
      renderIngrediente(searchInput.value);
    });

    incarcaDinLocalStorage();
    renderIngrediente();
  </script>
</body>
</html>
  </script>
</body>
</html>
